<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>{{ pageTitle }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content color="medium">
  <!-- Store Info -->
  <div class="container-padding card-border-radius">
    <div class="relative container card-border-radius">
      <div class="content">
        <ion-icon name="card-sharp" class="icon text-color"></ion-icon>
        <div style="padding-top: 15px">
          <ion-card-subtitle class="card-title text-color"
            >{{ selectedIns.storeName }}</ion-card-subtitle
          >
          <ion-card-title class="card-subtitle text-color">
            {{ selectedIns.location }}
          </ion-card-title>
        </div>
      </div>

      <div class="min-fee text-color">
        min sipariş tutarı {{ selectedIns.minFee }},00tl
        <br />
        {{selectedIns.discountFee}},00tl ve üzeri siparişlerde ücretsiz servis
      </div>
    </div>
  </div>

  <!--service and discount button-->
  <div class="button-container">
    <ion-button class="toLowerCase service-select-btn" color="secondary ">
      <ion-icon slot="start" name="ellipse-outline"></ion-icon>
      <ion-icon slot="end" name="chevron-down-outline"></ion-icon>
      çamaşır yıkama
    </ion-button>

    <ion-button class="text-color" color="medium" style="font-size: 0.7rem">
      <ion-icon
        slot="start"
        name="settings-sharp"
        class="text-color discount-btn"
      ></ion-icon>
      <div class="text-color toLowerCase">kampanyalar</div>
    </ion-button>
  </div>

  <!-- Store list -->
  <div class="store-items-container">
    <ion-searchbar
      (ionChange)="onInput($event)"
      (ionClear)="onCancel()"
      placeholder="ürün ara"
      class="searchbar"
    ></ion-searchbar>

    <div *ngIf="alreadyAddedToCard else default" class="card-padding">
      <ion-item
        button
        lines="none"
        detail="false"
        color="medium"
        class="store-menu-container"
      >
        <app-store-item
          itemName="{{alreadyAddedToCard.kindName}}"
          [itemType]="alreadyAddedToCard.type"
          itemImage="{{alreadyAddedToCard.kindImage}}"
          [itemDeliveryDate]="alreadyAddedToCard.deliveryDate"
          style="width: 100%"
        ></app-store-item>
      </ion-item>
      <div>
        <app-types
          [itemCost]="alreadyAddedToCard.price"
          [totalCost]="alreadyAddedToCard.price"
          [cardSize]="alreadyAddedToCard.amount"
          [initialtype]="alreadyAddedToCard.type"
          [standard]="standardDelivery"
          [premium]="premiumDelivery"
          [express]="expressDelivery"
          (cancelled)="cancelSelected(false)"
          (type)="changeTypeOfSelected($event)"
          (amount)="changeAmountOfSelected($event)"
        ></app-types>

        <!--Button to add to card-->
        <div class="btn-padding">
          <ion-button shape="round" expand="block" (click)="updateCard()"
            >sepeti güncelle</ion-button
          >
        </div>
      </div>
    </div>

    <ng-template #default>
      <div *ngFor="let item of storeItemList">
        <!-- selected card item displayed below item-->
        <div
          *ngIf="select === true && selected ===item && !alreadyAddedToCard else onlyList"
          class="card-padding"
        >
          <ion-item
            button
            lines="none"
            detail="false"
            color="medium"
            class="store-menu-container"
            (click)="selectItem(item)"
          >
            <app-store-item
              itemName="{{item.kindName}}"
              [itemType]="selected.type"
              itemImage="{{item.kindImage}}"
              [itemDeliveryDate]="item.deliveryDate"
              style="width: 100%"
            ></app-store-item>
          </ion-item>
          <div>
            <app-types
              [itemCost]="selected.price"
              [totalCost]="selected.price"
              [cardSize]="1"
              [standard]="standardDelivery"
              [premium]="premiumDelivery"
              [express]="expressDelivery"
              (cancelled)="cancelSelected(false)"
              (type)="changeTypeOfSelected($event)"
              (amount)="changeAmountOfSelected($event)"
            ></app-types>

            <!--Button to add to card-->
            <div class="btn-padding">
              <ion-button shape="round" expand="block" (click)="addToCard()"
                >sepete ekle</ion-button
              >
            </div>
          </div>
        </div>

        <ng-template #onlyList>
          <div *ngIf="item.kindName.toLowerCase().includes(searchName)">
            <ion-item
              button
              lines="none"
              detail="false"
              color="medium"
              class="store-menu-container"
              (click)="selectItem(item)"
            >
              <app-store-item
                itemName="{{item.kindName}}"
                itemCost="{{item.price}}"
                itemImage="{{item.kindImage}}"
                style="width: 100%"
              ></app-store-item>
            </ion-item>
          </div>
        </ng-template>
      </div>
    </ng-template>
  </div>
</ion-content>
